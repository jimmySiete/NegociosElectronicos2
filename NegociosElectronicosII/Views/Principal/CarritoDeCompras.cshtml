@model IEnumerable<NegociosElectronicosII.Models.NE_Carrito>

@{
    ViewBag.Title = "CarritoDeCompras";
    Layout = "~/Views/Shared/_PrincipalLayout.cshtml";
}



<!-- ========================= SECTION CONTENT ========================= -->
<section class="section-content bg padding-y border-top">
    <div class="container">

        <div class="row">
            <main class="col-sm-9">

                <div class="card">
                    <table class="table table-hover shopping-cart-wrap">
                        <thead class="text-muted">
                            <tr>
                                <th scope="col">Product</th>
                                <th scope="col" width="120">Quantity</th>
                                <th scope="col" width="120">Price</th>
                                <th scope="col" class="text-right" width="200">Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            @if (Settings.LoggedUser != null)
                            {
                                foreach (var item in Model)
                                {
                                    <tr>
                                        <td>
                                            <figure class="media">
                                                @if (item.ProductoId == null)
                                                {
                                                    <div class="img-wrap"><img src="@Url.Content("~/Imagenes/Vehiculo/" +@item.NE_Vehiculo.NE_VehiculoImagen.First().Nombre+@item.NE_Vehiculo.NE_VehiculoImagen.First().Extension)" class="img-thumbnail img-sm"></div>
                                                }
                                                else
                                                {
                                                    <div class="img-wrap"><img src="@Url.Content("~/Imagenes/Productos/" +@item.NE_Producto.NE_ProductoImagen.First().Nombre+@item.NE_Producto.NE_ProductoImagen.First().Extension)" class="img-thumbnail img-sm"></div>
                                                }

                                            <figcaption class="media-body">
                                                @if (item.ProductoId == null)
                                                {
                                                    <h6 class="title text-truncate">@item.NE_Vehiculo.NombreVehiculo </h6>
                                                    <dl class="dlist-inline small">
                                                        <dt>Marca: </dt>
                                                        <dd>@item.NE_Vehiculo.NE_Marca.Marca</dd>
                                                        <dt>Color: </dt>
                                                        <dd>@item.NE_Vehiculo.NE_Color.Color</dd>
                                                    </dl>
                                                    <dl class="dlist-inline small">
                                                        <dt>Categoria: </dt>
                                                        <dd>@item.NE_Vehiculo.NE_Categoria.Categoria</dd>
                                                        <dt>Transmisión: </dt>
                                                        <dd>@item.NE_Vehiculo.NE_Transmision.Transmision</dd>
                                                    </dl>

                                                }
                                                else
                                                {
                                                    <h6 class="title text-truncate">@item.NE_Producto.Nombre </h6>
                                                    <dl class="dlist-inline small">
                                                        <dt>Marca: </dt>
                                                        <dd>@item.NE_Producto.NE_Marca.Marca</dd>
                                                    </dl>
                                                    <dl class="dlist-inline small">
                                                        <dt>Color: </dt>
                                                        <dd>@item.NE_Producto.NE_Color.Color</dd>
                                                    </dl>
                                                }

                                            </figcaption>
                                            </figure>
                                        </td>
                                        <td>
                                            <select class="form-control">
                                                <option>1</option>
                                                <option>2</option>
                                                <option>3</option>
                                                <option>4</option>
                                            </select>
                                        </td>
                                        <td>
                                            @if (item.ProductoId == null)
                                            {
                                                if (item.NE_Vehiculo.MarcarComoOferta)
                                                {
                                                    <span class="price">@String.Format("{0:C2}", item.NE_Vehiculo.PrecioOFerta)</span>
                                                    <del class="price-old">@String.Format("{0:C2}", item.NE_Vehiculo.PrecioVenta)</del>
                                                }
                                                else
                                                {
                                                    <span class="price">@String.Format("{0:C2}", item.NE_Vehiculo.PrecioVenta)</span>
                                                }
                                            }
                                            else
                                            {
                                                if (item.NE_Producto.MarcarComoOferta)
                                                {
                                                    <var class="price">@String.Format("{0:C2}", item.NE_Producto.PrecioOFerta)</var>
                                                    <del class="price-old">@String.Format("{0:C2}", item.NE_Producto.PrecioVenta)</del>
                                                }
                                                else
                                                {   
                                                     <span class="price">@String.Format("{0:C2}", item.NE_Producto.PrecioVenta)</span>
                                                   
                                                }
                                            }
                                    </td>
                                        <td class="text-right">
                                            @if (item.ProductoId == null)
                                            {
                                                <button data-original-title="Agregar a Lista de Deseados" type="submit" id="@item.VehiculoId" onclick="agregarDeseo(@item.VehiculoId,1)" class="btn btn-outline-success" data-toggle="tooltip">
                                                    <i class="fa fa-heart"></i>
                                                </button>
                                                <button class="btn btn-outline-danger" type="submit" id="delete_@item.VehiculoId" onclick="eliminarCarrito(@item.VehiculoId,1)"> × Remove</button>
                                            }
                                            else
                                            {
                                                <button data-original-title="Agregar a Lista de Deseados" type="submit" id="@item.ProductoId" onclick="agregarDeseo(@item.ProductoId,2)" class="btn btn-outline-success" data-toggle="tooltip">
                                                    <i class="fa fa-heart"></i>
                                                </button>
                                                <button class="btn btn-outline-danger" type="submit" id="delete_@item.ProductoId" onclick="eliminarCarrito(@item.ProductoId,2)"> × Remove</button>
                                            }
                                        </td>
                                    </tr>
                                }
                            }
                            else
                            {
                                 <h3>No hay datos en el carrito</h3> 
                            }
                        </tbody>
                    </table>
                </div> <!-- card.// -->
           
            </main> <!-- col.// -->
            <aside class="col-sm-3">
                <p class="alert alert-success">Add USD 5.00 of eligible items to your order to qualify for FREE Shipping. </p>
                <dl class="dlist-align">
                    <dt>Total price: </dt>
                    <dd class="text-right">USD 568</dd>
                </dl>
                <dl class="dlist-align">
                    <dt>Discount:</dt>
                    <dd class="text-right">USD 658</dd>
                </dl>
                <dl class="dlist-align h4">
                    <dt>Total:</dt>
                    <dd class="text-right"><strong>USD 1,650</strong></dd>
                </dl>
                <hr>
                <figure class="itemside mb-3">
                    <aside class="aside"><img src="images/icons/pay-visa.png"></aside>
                    <div class="text-wrap small text-muted">
                        Pay 84.78 AED ( Save 14.97 AED )
                        By using ADCB Cards
                    </div>
                </figure>
                <figure class="itemside mb-3">
                    <aside class="aside"> <img src="images/icons/pay-mastercard.png"> </aside>
                    <div class="text-wrap small text-muted">
                        Pay by MasterCard and Save 40%. <br>
                        Lorem ipsum dolor
                    </div>
                </figure>

            </aside> <!-- col.// -->
        </div>

    </div> <!-- container .//  -->
</section>
<!-- ========================= SECTION CONTENT END// ========================= -->
<script type="text/javascript">

    function agregarDeseo(nuevo, cons) {
        $.ajax({
            url: '@Url.Action("AgregarDeseo", "ListaDeseos")',
            data: { id: nuevo, constante: cons },
            type: 'POST',
            success: function (response) {
                    RefrescarDeseos();
                    alert(response.Message);
                },
                error: function () {
                    alert('Error');
                }
        });
    }

    
    function eliminarCarrito(nuevo, cons) {
        $.ajax({
            url: '@Url.Action("EliminarCarro", "Carrito")',
            data: { id: nuevo, constante: cons },
            type: 'POST',
            success: function (response) {
                    window.location.href = '@Url.Action("CarritoDeCompras","Principal")';
                    RefrescarCarrito();
                    alert(response.Message);
                },
                error: function () {
                    alert('Error');
                }
        });
    }

</script>
